const apiURL="https://rest.coinapi.io";function getBTCCurrentPrice(){return new Promise(((e,t)=>{const n=new XMLHttpRequest;n.onreadystatechange=function(s){if(4===this.readyState&&200===this.status){if("string"!=typeof n.response)return void t();e(1/n.response)}else 4===this.readyState&&t()},n.open("GET","https://blockchain.info/tobtc?currency=EUR&value=1",!0),n.send()}))}function getPrice(e){e.setDate(e.getDate()-1);const t=e.getFullYear();let n=e.getMonth()+1,s=e.getDate();n<=9&&(n="0"+n),s<=9&&(s="0"+s);const r=`/v1/exchangerate/BTC/EUR?time=${t}${n}${s}`;return new Promise(((e,t)=>{const n=new XMLHttpRequest;n.onreadystatechange=function(s){if(4===this.readyState&&200===this.status){const t=JSON.parse(n.responseText);t.rate&&e(t.rate)}else 4===this.readyState&&t(this.status)},n.open("GET",apiURL+r,!0),n.setRequestHeader("X-CoinAPI-Key","33FB9E6F-E14B-49DE-8B2C-17CDCA3E5DAA"),n.setRequestHeader("Accept","application/json"),n.send()}))}!async function(){const e=document.querySelector("#year-picker");for(let t=2011;t<=(new Date).getFullYear();t++){const n=document.createElement("option");n.text=t,n.value=t,e.add(n)}e.options[e.options.length-1].selected=!0;const t=document.querySelector("#pl-result"),n=document.querySelector("#wanna-cry"),s=document.getElementsByName("euros-invested")[0];e.addEventListener("change",(()=>{a()})),s.addEventListener("change",(()=>{a()}));const r=document.querySelector("#error-display"),a=()=>{r.style.visibility="hidden",t.textContent="..."};try{const a=await getBTCCurrentPrice();n.addEventListener("click",(async n=>{try{const n=new Date;n.setFullYear(+e.value);const r=await getPrice(n),i=(+s.value/r*a).toFixed(2);var c=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",currencyDisplay:"code"});t.textContent=c.format(i)}catch(e){r.style.visibility="visible"}}))}catch(e){r.style.visibility="visible"}}();